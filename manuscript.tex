%
% ICRA 2013 Paper Submission
% created on Sep 5, 2012
%
\def \papertitle{Cooperative Control for Narrow Passage Traversal with a Flapping-Wing Micro Air Vehicle and Lightweight Ground Station}

% NOTE: WE WRITE ALL TEXT IN FIRST PERSON PLURAL ("we")
% Conventions: flapping-wing, small-scale

%!TEX TS-program = latex
%!TEX encoding = UTF-8 Unicode

\documentclass[letterpaper, 10 pt, conference]{ieeeconf}
\IEEEoverridecommandlockouts % for \thanks
\overrideIEEEmargins % for \addtolength

% Packages
\usepackage{color}
\usepackage[pdftex]{graphicx}
\usepackage{subfig}
\usepackage{multirow}
\usepackage{rotating}
\usepackage[pdftex]{hyperref}

% hyperref setup
\definecolor{linkCol}{gray}{0.25}
\hypersetup{
    pdftitle={\papertitle},
    pdfauthor={Ryan C. Julian, Cameron J. Rose, Humphrey Hu, and Ronald S. Fearing},
    pdfsubject={},
    pdfkeywords={},
    pdfpagemode=UseOutlines, bookmarksopen, bookmarksnumbered,
    colorlinks, linkcolor=linkCol, citecolor=linkCol, urlcolor=linkCol
}

% Title
\title{\LARGE \bf \papertitle}

% Authors
\author{
    Ryan C. Julian$^{*}$,
    Cameron J. Rose$^{*}$,
    Humphrey Hu$^{\dagger}$, and
    Ronald S. Fearing$^{*}$
    \thanks{$^{*}$
    	R.C. Julian, C.J. Rose and R.S. Fearing are
        with the Department of Electrical Engineering and Computer Sciences,
        University of California, Berkeley, CA 94720 USA.
        \href{mailto:ryanjulian@berkeley.edu}{\tt ryanjulian@berkeley.edu},
        \href{mailto:c\_rose@eecs.berkeley.edu}{\tt c\_rose@eecs.berkeley.edu},
        \href{mailto:ronf@eecs.berkeley.edu}{\tt ronf@eecs.berkeley.edu}
    }
    \thanks{$^{\dagger}$
        H. Hu is with the Robotics Institute,
        Carnegie Mellon University, Pittsburgh, PA 15213 USA.
        \href{mailto:humphreh@andrew.cmu.edu}{\tt humphreh@andrew.cmu.edu}
    }
    \thanks{
        This material is based upon work supported by the National Science
        Foundation under Grants No. CNS-0931463, and by the Army Research
        Laboratory under the Micro Autonomous System and Technology
        Collaborative Technology Alliance.
    }
}

\begin{document}

\maketitle
\thispagestyle{empty}
\pagestyle{empty}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
%TODO(ryan)
The power, size, and weight constraints of micro air vehicle (MAV) platforms limit their on-board sensing and computational resources. In this work, we demonstrate cooperative control of a 14 gram ornithopter MAV by a lightweight ground station using computer vision. We also introduce a new ornithopter MAV platform, the h$^2$Bird, which...
\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
%TODO(ryan)
The power, size, and weight constraints of micro air vehicle (MAV) platforms significantly limit on-board sensing and computational resources, and thus the complexity of the control and state estimation algorithms which can be executed on-board. These constraints are particularly severe for flapping wing MAVs offer the promise of superior safety, efficiency, and noise profile to rotor craft MAVs, but at the expense of payload weight.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Robotic and Vision Platforms}
%TODO(ryan)

%----------------------------------------------------------------------------%
\subsection{h$^2$Bird Ornithoper MAV}
%TODO(humphrey)
<<<<<<< HEAD
\begin{figure}[tb]
\centering
\includegraphics[width=\linewidth]{figures/h2bird.jpg}
\caption{h$^2$Bird Ornithopter MAV}
\label{fig:H2Bird}
\end{figure}

=======
The flying platform used in this experiment is the H2Bird flapping wing MAV. Built around the Silverlit I-Bird RC flyer powertrain and clap-fling wings, the H2Bird has a wingspan of [40?] cm and weighs [14?] grams fully loaded. A tail propeller and servo-controlled tail elevator provide control in the yaw and pitch axes. An onboard electronics package combines a 40 MIPS microprocessor, 6 DoF IMU, 802.15.4 radio, VGA camera, and motor drivers with a 90 mAh lithium polymer battery for autonomous flight. In routine flight, the H2Bird averages [insert speed] m/s ground speed and can operate for approximately [10] minutes.
>>>>>>> origin/humphrey

%----------------------------------------------------------------------------%
\subsection{Ground Station Computer Vision Platform}
%TODO(ryan)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{System Concept and Algorithms}
%TODO(ryan)

%----------------------------------------------------------------------------%
\subsection{Ornithoper Flight Control}
%TODO(humphrey)

\begin{figure}[tb]
\centering
\includegraphics[width=\linewidth]{figures/h2bird_axes.jpg}
\caption{h$^2$Bird Ornithopter with flight control axes}
\label{fig:H2Bird}
\end{figure}

We use simple controllers to actuate the h$^2$Bird's wing beat frequency, tail rotor, and tail elevator, which we designed to actuate thrust, yaw, and pitch respectively. Due to the high pitch angles experienced by the h$^2$Bird, we use a quaternion representation of vehicle attitude to avoid the numerical instabilities of Euler angle representations. Given a reference attitude $q$, we define the error $q_e$ as the rotation required to reach the reference attitude from the measured attitude. We then linearize the error quaternion to produce body axis angular errors. Three independent proportional-integral-derivative controllers commanding the wing thrust, elevator, and tail propeller. We use this independent PID controller architecture for simplicity in tuning and implementation, and because it demonstrates acceptable performance in the absence of a system model.
Rudimentary attitude control for the H2Bird runs onboard, estimating pose by naively integrating the IMU and depending on PID for control. The simplistic nature of our state estimation and control is due to the stringent resource constraints applied by the platform.

A quaternion representation of vehicle pose was chosen to avoid Euler angle singularities. This choice of pose representation also lends itself well to remote guidance, as relative body and world coordinate angular displacements can be represented compactly with quaternion multiplication. 

Given a reference attitude $q$, the error $q_e$ is defined as the rotation required to reach the reference from the current pose. The components of the error quaternion are then linearized to produce body axis angular errors. Control of the pitch and yaw axes is handled by three PID loops commanding the wing thrust, elevator, and tail prop.

\begin{equation}
\label{quat_error}
q_e = q'\otimes q_r
\end{equation}

\begin{equation}
\label{quat_angle}
\alpha = 2acos(q_{e,w})
\end{equation}

\begin{equation}
\label{quat_linearize}
Q_e = \alpha*q_e/sin(\alpha /2)
\end{equation}

%----------------------------------------------------------------------------%
\subsection{Pose Estimation}
%TODO(ryan)

%----------------------------------------------------------------------------%
\subsection{Visual Servoing}
%TODO(ryan)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Experiments}
%TODO(ryan)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Performance}
%TODO(ryan)

%----------------------------------------------------------------------------%
\subsection{MAV Internal Control}
%TODO(cameron)

%----------------------------------------------------------------------------%
\subsection{Pose Estimation}
%TODO(ryan)

%----------------------------------------------------------------------------%
\subsection{Visual Servoing}
%TODO(ryan)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\addtolength{\textheight}{-0cm}
                        % This command serves to balance the column lengths
                        % on the last page of the document manually. It shortens
                        % the textheight of the last page by a suitable amount.
                        % This command does not take effect until the next page
                        % so it should come on the page before the last. Make
                        % sure that you do not shorten the textheight too much.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions and Future Work}
%TODO(ryan)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Acknowledgements}
The authors would like to thank Fernando Garcia Bermudez for his assistance with the Vicon motion capture system, Andrew Pullin for his help with robot photography, and the members of the Biomimetic Millisystems Laboratory and the EECS community at the University of California, Berkeley for their advice and support.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{IEEEtranS}
\bibliography{}

\end{document}
